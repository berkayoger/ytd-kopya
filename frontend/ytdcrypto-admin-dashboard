<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YTDCrypto Y繹netim Paneli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Dark Tech (Slate, Indigo, Cyan, Violet) -->
    <!-- Application Structure Plan: The application is designed as a classic admin dashboard with a fixed sidebar for navigation and a main content area that dynamically displays the selected section. This structure is ideal for managing complex information by separating different management areas (users, content, system monitoring) into distinct, easily accessible views. The user flow is straightforward: an admin selects a category from the sidebar (e.g., 'Kullan覺c覺 Y繹netimi'), and the main content area updates to show relevant data, tables, and charts for that category. This design was chosen for its scalability and user-friendliness in a data-rich administrative context. -->
    <!-- Visualization & Content Choices:
        - Report Info: Genel Bak覺 (Abone Say覺s覺, Gelir) -> Goal: Inform (High-Level KPIs) -> Viz/Presentation: Stat Cards with Icons -> Interaction: Static display. -> Justification: Provides a quick, scannable summary of key business metrics. -> Library/Method: HTML/CSS/Icons.
        - Report Info: Abone B羹y羹me Grafii -> Goal: Show Trend -> Viz/Presentation: Bar Chart -> Interaction: Hover tooltips. -> Justification: Effectively visualizes user growth over time. -> Library/Method: Chart.js (Canvas).
        - Report Info: Abone Da覺l覺m覺 -> Goal: Show Proportion -> Viz/Presentation: Donut Chart -> Interaction: Hover tooltips. -> Justification: Clearly shows the distribution of subscription plans. -> Library/Method: Chart.js (Canvas).
        - Report Info: Kullan覺c覺 Listesi -> Goal: Organize & Manage -> Viz/Presentation: Interactive Table -> Interaction: Search, filter, buttons for actions. -> Justification: A standard and effective way to manage lists of users. -> Library/Method: Vanilla JS for interaction.
        - Report Info: 襤癟erik Y繹netimi (Coins, Plans) -> Goal: Organize & Manage -> Viz/Presentation: Cards with action buttons -> Interaction: Clickable buttons (simulated modals). -> Justification: Provides clear entry points for managing different content types. -> Library/Method: Vanilla JS.
        - Report Info: Sistem 襤zleme (API, Celery) -> Goal: Monitor Health -> Viz/Presentation: Line Chart (API), Donut Chart (Celery), Status Indicators -> Interaction: Hover tooltips. -> Justification: Visualizes system performance and health for quick diagnostics. -> Library/Method: Chart.js (Canvas).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* slate-900 */
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; /* slate-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4f46e5; /* indigo-600 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6366f1; /* indigo-500 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 350px;
            max-height: 400px;
        }
        .input-field {
            @apply bg-slate-900 border border-slate-700 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none;
        }
        /* Notification/Snackbar styles */
        #notification-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            width: 100%;
            max-width: 300px;
        }
        .notification-item {
            background-color: #1e293b; /* slate-800 */
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            border: 1px solid #334155;
            display: flex;
            align-items: center;
            justify-content: space-between;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        .notification-item.show {
            opacity: 1;
            transform: translateY(0);
        }
        .notification-item.hide {
            opacity: 0;
            transform: translateY(-20px);
        }
        .notification-item.success {
            background-color: #10b981; /* emerald-500 */
            border-color: #059669; /* emerald-600 */
        }
        .notification-item.error {
            background-color: #ef4444; /* red-500 */
            border-color: #dc2626; /* red-600 */
        }
        .notification-item button {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            font-size: 1rem;
            margin-left: 0.5rem;
            opacity: 0.7;
        }
        .notification-item button:hover {
            opacity: 1;
        }
    </style>
</head>
<body class="text-slate-200">

    <div class="flex h-screen bg-slate-900">
        <!-- Sidebar -->
        <aside id="sidebar" class="w-64 bg-slate-950 flex-shrink-0 p-4 border-r border-slate-800 lg:block hidden">
            <div class="flex items-center mb-8">
                <h1 class="text-2xl font-bold text-white">YTDCrypto <span class="text-indigo-400">Admin</span></h1>
            </div>
            <nav class="space-y-2">
                <a href="#" class="nav-link active flex items-center p-3 rounded-lg text-white bg-indigo-600" data-section="genel-bakis">
                    <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>
                    Genel Bak覺
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="kullanici-yonetimi">
                    <i data-lucide="users" class="w-5 h-5 mr-3"></i>
                    Kullan覺c覺 Y繹netimi
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="icerik-yonetimi">
                    <i data-lucide="file-cog" class="w-5 h-5 mr-3"></i>
                    襤癟erik Y繹netimi
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="sistem-izleme">
                    <i data-lucide="activity" class="w-5 h-5 mr-3"></i>
                    Sistem 襤zleme
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="olay-gecmisi">
                    <i data-lucide="list-checks" class="w-5 h-5 mr-3"></i>
                    Olay Ge癟mii
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="raporlama">
                    <i data-lucide="bar-chart-3" class="w-5 h-5 mr-3"></i>
                    Raporlama
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="duyuru-yonetimi">
                    <i data-lucide="megaphone" class="w-5 h-5 mr-3"></i>
                    Duyuru Y繹netimi
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="bildirimler">
                    <i data-lucide="bell-ring" class="w-5 h-5 mr-3"></i>
                    Bildirim Mekanizmas覺
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="auto-ta">
                    <i data-lucide="cpu" class="w-5 h-5 mr-3"></i>
                     Otomatik Teknik Tahminler
                </a>
                 <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="guvenlik-yonetimi">
                    <i data-lucide="shield" class="w-5 h-5 mr-3"></i>
                    G羹venlik Y繹netimi
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="yonetici-rolleri">
                    <i data-lucide="user-check" class="w-5 h-5 mr-3"></i>
                    Yetkilendirme ve Rol Y繹netimi
                </a>
                <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-slate-800 transition-colors" data-section="yedekleme">
                    <i data-lucide="cloud-download" class="w-5 h-5 mr-3"></i>
                    Yedekleme & Geri Y羹kleme
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-slate-950 p-4 border-b border-slate-800 flex justify-between items-center">
                 <button id="menu-toggle" class="lg:hidden text-white">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <div class="text-lg font-semibold text-white">Y繹netim Paneli</div>
                <div class="flex items-center space-x-4">
                    <i data-lucide="bell" class="w-5 h-5 text-slate-400"></i>
                    <span class="text-sm">Admin User</span>
                    <img src="https://placehold.co/40x40/6366f1/FFFFFF?text=A" alt="Admin Avatar" class="w-8 h-8 rounded-full">
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-slate-900 p-6">
                <!-- Section: Genel Bak覺 -->
                <section id="genel-bakis" class="content-section">
                    <h2 class="text-2xl font-bold mb-6 text-white">Genel Bak覺</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="text-slate-400 text-sm font-medium">Toplam Abone</h3>
                            <p class="text-3xl font-bold text-white mt-2">1,257</p>
                            <p class="text-sm text-green-400 mt-1">+12% ge癟en aydan</p>
                        </div>
                        <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="text-slate-400 text-sm font-medium">Ayl覺k Gelir (Tahmini)</h3>
                            <p class="text-3xl font-bold text-white mt-2">$15,842</p>
                             <p class="text-sm text-green-400 mt-1">+8% ge癟en aydan</p>
                        </div>
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="text-slate-400 text-sm font-medium">Aktif API ar覺lar覺 (24s)</h3>
                            <p class="text-3xl font-bold text-white mt-2">1,34M</p>
                             <p class="text-sm text-red-400 mt-1">-5% ge癟en g羹nden</p>
                        </div>
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="text-slate-400 text-sm font-medium">Sunucu Sal覺覺</h3>
                            <p class="text-3xl font-bold text-green-400 mt-2">Stabil</p>
                            <p class="text-sm text-slate-400 mt-1">99.98% uptime</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="font-semibold text-white">Abone B羹y羹me Grafii (Son 6 Ay)</h3>
                            <div class="chart-container mt-4"><canvas id="aboneBuyumeChart"></canvas></div>
                        </div>
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <h3 class="font-semibold text-white">Abonelik Da覺l覺m覺</h3>
                            <div class="chart-container mt-4"><canvas id="abonelikDagilimChart"></canvas></div>
                        </div>
                    </div>
                </section>
                
                <!-- Section: Kullan覺c覺 Y繹netimi -->
                <section id="kullanici-yonetimi" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Kullan覺c覺 Y繹netimi</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 space-y-2 sm:space-y-0">
                            <div class="flex items-center space-x-2 w-full sm:w-auto">
                                <input type="text" placeholder="Kullan覺c覺 ara..." class="input-field w-full sm:w-auto">
                                <select class="input-field w-full sm:w-auto">
                                    <option>T羹m Planlar</option>
                                    <option>BASIC</option>
                                    <option>ADVANCED</option>
                                    <option>PREMIUM</option>
                                    <option>TRIAL</option>
                                </select>
                            </div>
                            <!-- Abonelik Kodu ret Formu -->
                            <div class="w-full sm:w-auto flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                                <select id="promo-plan-select" class="input-field">
                                    <option value="BASIC">BASIC</option>
                                    <option value="ADVANCED">ADVANCED</option>
                                    <option value="PREMIUM">PREMIUM</option>
                                    <option value="TRIAL">TRIAL</option>
                                </select>
                                <input type="number" id="promo-duration-input" placeholder="S羹re (g羹n)" class="input-field w-24" value="30">
                                <input type="number" id="promo-uses-input" placeholder="Kullan覺m" class="input-field w-24" value="1">
                                <button id="generate-promo-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Kod ret</button>
                            </div>
                        </div>
                        <div id="promo-code-message" class="text-sm text-center my-2 hidden"></div>

                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700">
                                    <tr>
                                        <th class="p-3">Kullan覺c覺 Ad覺</th>
                                        <th class="p-3">E-posta</th>
                                        <th class="p-3">Plan</th>
                                        <th class="p-3">Kay覺t Tarihi</th>
                                        <th class="p-3">襤lemler</th>
                                    </tr>
                                </thead>
                                <tbody id="user-table-body">
                                    <!-- Kullan覺c覺lar buraya dinamik y羹klenecek -->
                                    <tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="5">Kullan覺c覺 bulunamad覺.</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <button id="load-more-users" class="bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md mt-4">Daha Fazla Y羹kle</button>
                    </div>
                </section>

                 <!-- Section: 襤癟erik Y繹netimi -->
                <section id="icerik-yonetimi" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">襤癟erik ve Konfig羹rasyon Y繹netimi</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <i data-lucide="coins" class="w-8 h-8 text-indigo-400 mb-4"></i>
                            <h3 class="font-bold text-lg text-white">Kripto Para Listesi</h3>
                            <p class="text-sm text-slate-400 mt-2">Yeni coin ekleyin veya mevcut coinlerin durumunu (aktif/pasif) y繹netin.</p>
                            <button id="manage-coins-btn" class="mt-4 bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md w-full">Y繹net</button>
                        </div>
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                            <i data-lucide="gem" class="w-8 h-8 text-indigo-400 mb-4"></i>
                            <h3 class="font-bold text-lg text-white">Abonelik Planlar覺</h3>
                            <p class="text-sm text-slate-400 mt-2">Planlar覺n fiyatlar覺n覺 ve 繹zelliklerini dinamik olarak g羹ncelleyin.</p>
                             <button id="manage-plans-btn" class="mt-4 bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md w-full">Y繹net</button>
                        </div>
                         <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                           <i data-lucide="image" class="w-8 h-8 text-indigo-400 mb-4"></i>
                            <h3 class="font-bold text-lg text-white">Web Sitesi Arka Plan覺</h3>
                            <p class="text-sm text-slate-400 mt-2">Ana sayfan覺n arka plan g繹rselini veya temas覺n覺 deitirin.</p>
                             <button id="manage-background-btn" class="mt-4 bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md w-full">Y繹net</button>
                        </div>
                    </div>

                    <!-- Kripto Para Y繹netim Alan覺 (Sim羹le) -->
                    <div id="crypto-management-area" class="bg-slate-800 p-6 rounded-lg border border-slate-700 mt-6 hidden">
                        <h3 class="text-xl font-bold mb-3 text-white">Kripto Para Ekle/Y繹net</h3>
                        <input type="text" id="new-coin-id" placeholder="Coin ID (繹rn: bitcoin)" class="input-field mb-2">
                        <input type="text" id="new-coin-name" placeholder="Coin Ad覺 (繹rn: Bitcoin)" class="input-field mb-2">
                        <input type="text" id="new-coin-symbol" placeholder="Coin Sembol羹 (繹rn: BTC)" class="input-field mb-4">
                        <button id="add-new-coin-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Yeni Coin Ekle</button>
                        <p class="text-sm text-slate-400 mt-4">Mevcut Coin Listesi (Sim羹le): BTC (Aktif), ETH (Aktif), XRP (Aktif)</p>
                    </div>

                    <!-- Abonelik Plan Y繹netim Alan覺 (Sim羹le) -->
                    <div id="subscription-plan-management-area" class="bg-slate-800 p-6 rounded-lg border border-slate-700 mt-6 hidden">
                        <h3 class="text-xl font-bold mb-3 text-white">Abonelik Planlar覺n覺 D羹zenle</h3>
                        <div class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-1">Plan Se癟:</label>
                                    <select id="edit-plan-select" class="input-field w-full">
                                        <option value="basic">BASIC</option>
                                        <option value="advanced">ADVANCED</option>
                                        <option value="premium">PREMIUM</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-1">Fiyat (USD/Ay):</label>
                                    <input type="number" id="edit-plan-price" class="input-field w-full" step="0.01" value="9.99">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-1">zellikler (Her sat覺r bir 繹zellik):</label>
                                <textarea id="edit-plan-features" class="input-field w-full" rows="4">zellik 1
zellik 2</textarea>
                            </div>
                            <div>
                                <h4 class="font-semibold text-white mb-2">API Limitleri:</h4>
                                <label class="block text-sm font-medium text-slate-300 mb-1">Analiz ar覺s覺 (G羹nl羹k):</label>
                                <input type="number" id="edit-plan-analyze-limit" class="input-field w-full" value="10">
                                <label class="block text-sm font-medium text-slate-300 mb-1 mt-2">LLM Sorgular覺 (G羹nl羹k):</label>
                                <input type="number" id="edit-plan-llm-limit" class="input-field w-full" value="2">
                            </div>
                            <button id="save-plan-changes-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md w-full">Deiiklikleri Kaydet</button>
                        </div>
                    </div>

                    <!-- Web Sitesi Arka Plan Y繹netim Alan覺 (Sim羹le) -->
                    <div id="background-management-area" class="bg-slate-800 p-6 rounded-lg border border-slate-700 mt-6 hidden">
                        <h3 class="text-xl font-bold mb-3 text-white">Arka Plan G繹rselini Deitir</h3>
                        <input type="text" id="background-url-input" placeholder="Yeni arka plan GIF/resim URL'si" class="input-field mb-2">
                        <button id="update-background-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Arka Plan覺 G羹ncelle</button>
                        <p class="text-sm text-slate-400 mt-4">Mevcut Arka Plan: <span id="current-background-url">Y羹kleniyor...</span></p>
                    </div>

                </section>
                
                 <!-- Section: Sistem 襤zleme -->
                <section id="sistem-izleme" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Sistem 襤zleme</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                           <h3 class="font-semibold text-white">API ar覺lar覺 (Son 7 G羹n)</h3>
                           <div class="chart-container mt-4"><canvas id="apiCagrilariChart"></canvas></div>
                       </div>
                        <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                           <h3 class="font-semibold text-white">Celery G繹rev Durumu</h3>
                           <div class="chart-container mt-4"><canvas id="celeryGorevChart"></canvas></div>
                       </div>
                    </div>
                </section>
                
                <!-- Section: Olay Ge癟mii -->
                <section id="olay-gecmisi" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Olay Ge癟mii</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <p class="text-slate-400 mb-4">Sistemdeki 繹nemli olaylar覺n ve kullan覺c覺 aktivitelerinin kayd覺.</p>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700">
                                    <tr>
                                        <th class="p-3">Zaman Damgas覺</th>
                                        <th class="p-3">Olay Tipi</th>
                                        <th class="p-3">A癟覺klama</th>
                                        <th class="p-3">Kullan覺c覺/Kaynak</th>
                                    </tr>
                                </thead>
                                <tbody id="event-history-table-body">
                                    <!-- Olaylar buraya dinamik y羹klenecek -->
                                    <tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="4">Olay kayd覺 bulunamad覺.</td></tr>
                                </tbody>
                            </table>
                        </div>
                         <button id="load-more-events" class="bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md mt-4">Daha Fazla Y羹kle</button>
                    </div>
                </section>

                 <!-- Section: Raporlama -->
                <section id="raporlama" class="content-section hidden">
                     <h2 class="text-2xl font-bold mb-6 text-white">Raporlama ve Analitik</h2>
                     <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <p class="text-slate-400">Detayl覺 abone b羹y羹me, kullan覺m ve gelir raporlar覺 burada yer alacak.</p>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                            <div class="bg-slate-900 p-6 rounded-lg border border-slate-700">
                                <h3 class="font-semibold text-white">Abone Say覺s覺</h3>
                                <p class="text-4xl font-bold text-indigo-400 mt-2">1,257</p>
                                <p class="text-sm text-slate-400 mt-1">Toplam aktif kullan覺c覺 say覺s覺</p>
                            </div>
                            <div class="bg-slate-900 p-6 rounded-lg border border-slate-700">
                                <h3 class="font-semibold text-white">Haftal覺k Yeni Abone</h3>
                                <p class="text-4xl font-bold text-green-400 mt-2">+35</p>
                                <p class="text-sm text-slate-400 mt-1">Son 7 g羹nde kay覺t olan kullan覺c覺 say覺s覺</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                            <div class="bg-slate-900 p-6 rounded-lg border border-slate-700">
                                <h3 class="font-semibold text-white">Ayl覺k Yeni Abone Grafii</h3>
                                <div class="chart-container mt-4"><canvas id="raporAylikAboneChart"></canvas></div>
                            </div>
                            <div class="bg-slate-900 p-6 rounded-lg border border-slate-700">
                                <h3 class="font-semibold text-white">Abonelik Plan Da覺l覺m覺</h3>
                                <div class="chart-container mt-4"><canvas id="raporPlanDagilimiChart"></canvas></div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="duyuru-yonetimi" class="content-section hidden">
                     <h2 class="text-2xl font-bold mb-6 text-white">Duyuru Y繹netimi</h2>
                      <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                          <p class="text-slate-400 mb-4">Web sitesinde duyurular yay覺nlay覺n veya kullan覺c覺lara bildirimler g繹nderin.</p>
                          <h3 class="font-bold text-lg text-white mb-3">Yeni Duyuru Olutur</h3>
                          <textarea placeholder="Duyuru metni..." class="input-field w-full mb-3"></textarea>
                          <button class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Duyuru Yay覺nla</button>
                      </div>
                </section>
                <section id="bildirimler" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Bildirim Mekanizmas覺</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <p class="text-slate-400 mb-4">Sistem uyar覺lar覺 ve g繹rev durumlar覺 i癟in bildirim ayarlar覺n覺 y繹netin.</p>
                        <h3 class="font-bold text-lg text-white mb-3">E-posta Bildirim Ayarlar覺</h3>
                        <div class="flex items-center space-x-3 mb-3">
                            <input type="checkbox" id="critical-alerts" class="rounded text-indigo-600 focus:ring-indigo-500">
                            <label for="critical-alerts" class="text-slate-300">Kritik Hatalarda E-posta G繹nder</label>
                        </div>
                        <div class="flex items-center space-x-3">
                            <input type="checkbox" id="task-failures" class="rounded text-indigo-600 focus:ring-indigo-500">
                            <label for="task-failures" class="text-slate-300">Celery G繹rev Baar覺s覺zl覺klar覺nda Bildir</label>
                        </div>
                    <button class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Ayarlar覺 Kaydet</button>
                </div>
                </section>
                <section id="auto-ta" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Otomatik Teknik Tahminler (TA-Strategy)</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700">
                                    <tr>
                                        <th class="p-3">Sembol</th>
                                        <th class="p-3">Hedef</th>
                                        <th class="p-3">Getiri %</th>
                                        <th class="p-3">G羹ven</th>
                                        <th class="p-3">Oluturulma</th>
                                    </tr>
                                </thead>
                                <tbody id="ta-table-body">
                                    <tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="5">Tahmin bulunamad覺.</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <button id="load-ta-btn" class="mt-4 bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md">Y羹kle</button>
                    </div>
                </section>
                <section id="guvenlik-yonetimi" class="content-section hidden">
                     <h2 class="text-2xl font-bold mb-6 text-white">G羹venlik Y繹netimi</h2>
                      <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                          <p class="text-slate-400 mb-4">API anahtar覺 y繹netimi, IP engelleme ve y繹netici rolleri burada yer alacak.</p>
                          <h3 class="font-bold text-lg text-white mb-3">G羹venlik Alarm Ge癟mii</h3>
                           <div class="overflow-x-auto mt-4">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700">
                                    <tr>
                                        <th class="p-3">Zaman</th>
                                        <th class="p-3">Tip</th>
                                        <th class="p-3">Kullan覺c覺</th>
                                        <th class="p-3">IP</th>
                                        <th class="p-3">iddet</th>
                                        <th class="p-3">Detaylar</th>
                                        <th class="p-3">Durum</th>
                                    </tr>
                                </thead>
                                <tbody id="security-alarms-table-body">
                                    <!-- Alarmlar buraya dinamik y羹klenecek -->
                                    <tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="7">Alarm kayd覺 bulunamad覺.</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="flex justify-between items-center mt-4 text-sm">
                            <button id="load-more-alarms" class="bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-md">Daha Fazla Y羹kle</button>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="show-unseen-alarms" class="rounded text-indigo-600 focus:ring-indigo-500">
                                <span class="text-slate-300">Sadece Okunmam覺lar覺 G繹ster</span>
                            </label>
                        </div>
                      </div>
                </section>
                <section id="yonetici-rolleri" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Yetkilendirme ve Rol Y繹netimi</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700">
                        <p class="text-slate-400 mb-4">Sistemdeki y繹netici kullan覺c覺lar覺 ve rollerini y繹netin.</p>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b border-slate-700">
                                    <tr>
                                        <th class="p-3">Y繹netici Ad覺</th>
                                        <th class="p-3">Rol</th>
                                        <th class="p-3">Durum</th>
                                        <th class="p-3">襤lemler</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-roles-table-body">
                                    <!-- Y繹neticiler buraya dinamik y羹klenecek -->
                                    <tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="4">Y繹netici bulunamad覺.</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <button id="add-new-admin-btn" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-md">Yeni Y繹netici Ekle</button>
                    </div>
                </section>
                <section id="yedekleme" class="content-section hidden">
                    <h2 class="text-2xl font-bold mb-6 text-white">Yedekleme ve Geri Y羹kleme</h2>
                    <div class="bg-slate-800 p-6 rounded-lg border border-slate-700 text-center">
                        <p class="text-slate-400 mb-4">Veritaban覺 ve sistem ayarlar覺n覺n yedeklerini al覺n veya geri y羹kleyin.</p>
                        <button class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md mr-4">Yedekleme Balat</button>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md">Yedekleri Listele</button>
                        <button class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-md mt-4 md:mt-0">Geri Y羹kle</button>
                        <p class="text-sm text-slate-500 mt-4">Son Yedekleme: 2025-06-25 03:00:00 (Baar覺l覺)</p>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons(); // Lucide ikonlar覺n覺 balat

            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');

            // Alarm Ge癟mii i癟in DOM elemanlar覺
            const securityAlarmsTableBody = document.getElementById('security-alarms-table-body');
            const loadMoreAlarmsButton = document.getElementById('load-more-alarms');
            const showUnseenAlarmsCheckbox = document.getElementById('show-unseen-alarms');
            let alarmOffset = 0; // Pagination i癟in offset
            const alarmLimit = 10; // Her y羹klemede g繹sterilecek alarm say覺s覺

            // Admin API Anahtar覺 (Bu sadece demo ama癟l覺d覺r. retimde g羹venli bir ekilde y繹netilmelidir.)
            const ADMIN_API_KEY = "your_admin_secret_key"; // .env'deki ADMIN_ACCESS_KEY ile ayn覺 olmal覺
            const BACKEND_BASE_URL = 'http://localhost:5000';
            const SECURITY_ALARMS_API_URL = `${BACKEND_BASE_URL}/api/admin/security_alarms`;
            const TA_PREDICTIONS_API_URL = `${BACKEND_BASE_URL}/api/admin/predictions?source_model=TA-Strategy`;

            const taTableBody = document.getElementById('ta-table-body');
            const loadTaButton = document.getElementById('load-ta-btn');
            let taPage = 1;

            // Sidebar navigation logic
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('data-section');

                    navLinks.forEach(l => l.classList.remove('active', 'bg-indigo-600'));
                    link.classList.add('active', 'bg-indigo-600');

                    contentSections.forEach(section => {
                        if (section.id === sectionId) {
                            section.classList.remove('hidden');
                        } else {
                            section.classList.add('hidden');
                        }
                    });

                    // Mobil cihazda sidebar'覺 kapat
                    if(window.innerWidth < 1024) {
                        sidebar.classList.add('hidden');
                    }

                    // G羹venlik Alarmlar覺 sekmesine t覺kland覺覺nda alarmlar覺 y羹kle
                    if (sectionId === 'guvenlik-yonetimi') {
                        alarmOffset = 0; // Her sekme deiiminde s覺f覺rla
                        securityAlarmsTableBody.innerHTML = ''; // Tabloyu temizle
                        fetchSecurityAlarms();
                    }
                    if (sectionId === 'auto-ta') {
                        taPage = 1;
                        taTableBody.innerHTML = '';
                        fetchTaPredictions();
                    }
                     // Kullan覺c覺 Y繹netimi sekmesine t覺kland覺覺nda kullan覺c覺lar覺 y羹kle
                    if (sectionId === 'kullanici-yonetimi') {
                        userOffset = 0; // Her sekme deiiminde s覺f覺rla
                        userTableBody.innerHTML = ''; // Tabloyu temizle
                        fetchUsers();
                    }
                     // 襤癟erik Y繹netimi sekmesine t覺kland覺覺nda ilgili alanlar覺 g繹ster/gizle
                    if (sectionId === 'icerik-yonetimi') {
                        hideAllContentManagementAreas();
                    }
                });
            });
            
            // Mobile menu toggle
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('hidden');
            });

            // --- Chart.js ---
            const chartConfig = {
                plugins: { legend: { labels: { color: '#94a3b8' } } },
                scales: {
                    x: { ticks: { color: '#94a3b8' }, grid: { color: 'rgba(71, 85, 105, 0.5)' } },
                    y: { ticks: { color: '#94a3b8' }, grid: { color: 'rgba(71, 85, 105, 0.5)' } }
                }
            };
            
            new Chart(document.getElementById('aboneBuyumeChart').getContext('2d'), {
                type: 'bar', data: { labels: ['Ocak', 'ubat', 'Mart', 'Nisan', 'May覺s', 'Haziran'], datasets: [{ label: 'Yeni Aboneler', data: [65, 59, 80, 81, 56, 120], backgroundColor: '#4f46e5', borderColor: '#6366f1', borderWidth: 1 }] }, options: chartConfig
            });
            new Chart(document.getElementById('abonelikDagilimChart').getContext('2d'), {
                type: 'doughnut', data: { labels: ['BASIC', 'ADVANCED', 'PREMIUM', 'TRIAL'], datasets: [{ label: 'Abone Da覺l覺m覺', data: [300, 550, 250, 157], backgroundColor: ['#3b82f6', '#8b5cf6', '#a855f7', '#f59e0b'], borderColor: '#1e293b', borderWidth: 2 }] }, options: { plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8' } } } }
            });
            new Chart(document.getElementById('apiCagrilariChart').getContext('2d'), {
                type: 'line', data: { labels: ['Pzt', 'Sal', 'ar', 'Per', 'Cum', 'Cmt', 'Paz'], datasets: [{ label: 'API ar覺lar覺 (Milyon)', data: [1.2, 1.9, 1.3, 1.5, 2.3, 1.8, 1.34], fill: true, backgroundColor: 'rgba(79, 70, 229, 0.2)', borderColor: '#4f46e5', tension: 0.3 }] }, options: chartConfig
            });
            new Chart(document.getElementById('celeryGorevChart').getContext('2d'), {
                type: 'doughnut', data: { labels: ['Baar覺l覺', 'Baar覺s覺z', 'Beklemede'], datasets: [{ label: 'G繹rev Durumu', data: [15200, 45, 120], backgroundColor: ['#10b981', '#ef4444', '#f59e0b'], borderColor: '#1e293b', borderWidth: 2 }] }, options: { plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8' } } } }
            });
            new Chart(document.getElementById('raporAylikAboneChart').getContext('2d'), {
                type: 'line', data: { labels: ['Temmuz', 'Austos', 'Eyl羹l', 'Ekim', 'Kas覺m', 'Aral覺k'], datasets: [{ label: 'Ayl覺k Yeni Aboneler', data: [70, 85, 60, 95, 75, 150], borderColor: '#22d3ee', backgroundColor: 'rgba(34, 211, 238, 0.2)', fill: true, tension: 0.4 }] }, options: chartConfig
            });
            new Chart(document.getElementById('raporPlanDagilimiChart').getContext('2d'), {
                type: 'pie', data: { labels: ['BASIC', 'ADVANCED', 'PREMIUM', 'TRIAL'], datasets: [{ label: 'Plan Da覺l覺m覺', data: [25, 45, 20, 10], backgroundColor: ['#60a5fa', '#a78bfa', '#f87171', '#fbbf24'], borderColor: '#1e293b', borderWidth: 2 }] }, options: { plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8' } } } }
            });

            // --- G羹venlik Alarmlar覺 襤levsellii ---
            // Alarm severity'ye g繹re renk s覺n覺f覺 d繹nd羹r羹r
            function getSeverityClass(severity) {
                switch (severity.toLowerCase()) {
                    case 'info': return 'text-blue-400';
                    case 'warning': return 'text-yellow-400';
                    case 'critical': return 'text-orange-400';
                    case 'fatal': return 'text-red-400';
                    default: return 'text-slate-400';
                }
            }

            // G羹venlik alarmlar覺n覺 backend'den 癟ek ve tabloya ekle
            async function fetchSecurityAlarms() {
                let url = `${SECURITY_ALARMS_API_URL}?limit=${alarmLimit}&offset=${alarmOffset}`;
                if (showUnseenAlarmsCheckbox.checked) {
                    url += '&unseen=1';
                }

                try {
                    const response = await fetch(url, {
                        headers: { 'X-ADMIN-API-KEY': ADMIN_API_KEY }
                    });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(errorData.error || `HTTP Error: ${response.status}`);
                    }
                    const alarms = await response.json();

                    if (alarms.length === 0 && alarmOffset === 0) {
                        securityAlarmsTableBody.innerHTML = '<tr class="border-b border-slate-800"><td class="p-3 text-slate-500" colspan="7">Hi癟 alarm bulunamad覺.</td></tr>';
                        loadMoreAlarmsButton.disabled = true;
                    } else if (alarms.length === 0) {
                        loadMoreAlarmsButton.disabled = true;
                    } else {
                        alarms.forEach(alarm => {
                            const row = document.createElement('tr');
                            row.className = 'border-b border-slate-800 hover:bg-slate-700';
                            const detailText = alarm.details ? alarm.details.substring(0, 50) + (alarm.details.length > 50 ? '...' : '') : 'N/A';
                            row.innerHTML = `
                                <td class="p-3">${new Date(alarm.created_at).toLocaleString('tr-TR')}</td>
                                <td class="p-3">${alarm.alert_type}</td>
                                <td class="p-3">${alarm.username || 'N/A'}</td>
                                <td class="p-3">${alarm.ip_address || 'N/A'}</td>
                                <td class="p-3 ${getSeverityClass(alarm.severity)}">${alarm.severity.toUpperCase()}</td>
                                <td class="p-3" title="${alarm.details}">${detailText}</td>
                                <td class="p-3">
                                    <button class="text-indigo-400 update-alarm-btn" data-alarm-id="${alarm.id}" data-action="seen" title="Okundu Olarak 襤aretle">
                                        <i data-lucide="check" class="w-4 h-4"></i>
                                    </button>
                                    <button class="text-emerald-400 update-alarm-btn" data-alarm-id="${alarm.id}" data-action="resolve" title="繹z羹ld羹 Olarak 襤aretle">
                                        <i data-lucide="check-check" class="w-4 h-4"></i>
                                    </button>
                                    <span class="ml-2 text-xs ${alarm.seen_by_admin ? 'text-green-400' : 'text-red-400'}">
                                        ${alarm.seen_by_admin ? 'Okundu' : 'Yeni'}
                                    </span>
                                </td>
                            `;
                            securityAlarmsTableBody.appendChild(row);
                        });
                        alarmOffset += alarms.length; // Offset'i g羹ncelle
                        loadMoreAlarmsButton.disabled = alarms.length < alarmLimit; // Eer y羹klenen alarm say覺s覺 limitten az ise butonu devre d覺覺 b覺rak
                        lucide.createIcons(); // Yeni ikonlar覺 render et
                    }
                } catch (error) {
                    console.error("G羹venlik alarmlar覺 癟ekilirken hata:", error);
                    showNotification(`G羹venlik alarmlar覺 y羹klenemedi: ${error.message}`, 'error');
                    securityAlarmsTableBody.innerHTML = `<tr class="border-b border-slate-800"><td class="p-3 text-red-400" colspan="7">Alarmlar y羹klenemedi: ${error.message}</td></tr>`;
                    loadMoreAlarmsButton.disabled = true;
                }
            }

            // "Daha Fazla Y羹kle" butonuna t覺klama ilevi
            loadMoreAlarmsButton.addEventListener('click', fetchSecurityAlarms);

            // "Sadece Okunmam覺lar覺 G繹ster" checkbox'覺na deiim ilevi
            showUnseenAlarmsCheckbox.addEventListener('change', () => {
                alarmOffset = 0; // Filtre deiince s覺f覺rla
                securityAlarmsTableBody.innerHTML = ''; // Tabloyu temizle
                fetchSecurityAlarms();
            });

            // Alarm durumu g羹ncelleme (Okundu/繹z羹ld羹)
            securityAlarmsTableBody.addEventListener('click', async (e) => {
                const targetButton = e.target.closest('.update-alarm-btn');
                if (!targetButton) return;

                const alarmId = targetButton.dataset.alarmId;
                const action = targetButton.dataset.action;
                let payload = {};

                if (action === 'seen') {
                    payload = { seen_by_admin: true };
                } else if (action === 'resolve') {
                    payload = { resolved: true };
                }

                try {
                    const response = await fetch(`${SECURITY_ALARMS_API_URL}/${alarmId}`, {
                        method: 'PATCH',
                        headers: {
                            'X-ADMIN-API-KEY': ADMIN_API_KEY, // Bu, art覺k JWT ile deimeli
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(errorData.error || `HTTP Error: ${response.status}`);
                    }
                    
                    showNotification('Alarm durumu g羹ncellendi!', 'success');
                    alarmOffset = 0; securityAlarmsTableBody.innerHTML = ''; fetchSecurityAlarms(); // Yeniden y羹kle
                } catch (error) { console.error('Alarm durumu g羹ncellenirken hata:', error); showNotification(`Alarm durumu g羹ncellenemedi: ${error.message}`, 'error'); }
            });

            // --- Kullan覺c覺 Y繹netimi 襤levsellii ---
            const userTableBody = document.getElementById('user-table-body');
            const loadMoreUsersButton = document.getElementById('load-more-users');
            const generatePromoButton = document.getElementById('generate-promo-btn');
            const promoPlanSelect = document.getElementById('promo-plan-select');
            const promoDurationInput = document.getElementById('promo-duration-input');
            const promoUsesInput = document.getElementById('promo-uses-input');
            const promoCodeMessage = document.getElementById('promo-code-message');

            let userOffset = 0; // Pagination i癟in offset
            const userLimit = 10; // Her y羹klemede g繹sterilecek kullan覺c覺 say覺s覺
            const USERS_API_URL = `${BACKEND_BASE_URL}/api/admin/users`;
            const PROMO_CODES_API_URL = `${BACKEND_BASE_URL}/api/admin/promo_codes`;

            async function fetchUsers() {
                try {
                    const response = await fetch(`${USERS_API_URL}?limit=${userLimit}&offset=${userOffset}`, {
                        headers: { 'X-ADMIN-API-KEY': ADMIN_API_KEY } // Bu, art覺k JWT ile deimeli
                    });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(errorData.error || `HTTP Error: ${response.status}`);
                    }
                    const users = await response.json();

                    if (users.length === 0 && userOffset === 0) {
                        userTableBody.innerHTML = '<tr class="border-b border-slate-800"><td class="p-3 text-slate-500" colspan="5">Hi癟 kullan覺c覺 bulunamad覺.</td></tr>';
                        loadMoreUsersButton.disabled = true;
                    } else if (users.length === 0) {
                        loadMoreUsersButton.disabled = true;
                    } else {
                        users.forEach(user => {
                            const row = document.createElement('tr');
                            row.className = 'border-b border-slate-800 hover:bg-slate-700';
                            const planClass = user.subscription_level === 'PREMIUM' ? 'bg-green-500' :
                                              user.subscription_level === 'ADVANCED' ? 'bg-blue-500' :
                                              user.subscription_level === 'BASIC' ? 'bg-indigo-500' :
                                              'bg-yellow-500'; // TRIAL i癟in
                            row.innerHTML = `
                                <td class="p-3">${user.username}</td>
                                <td class="p-3">${user.email || 'N/A'}</td>
                                <td class="p-3"><span class="${planClass} text-white text-xs px-2 py-1 rounded-full">${user.subscription_level.toUpperCase()}</span></td>
                                <td class="p-3">${new Date(user.created_at).toLocaleDateString('tr-TR')}</td>
                                <td class="p-3 flex space-x-2">
                                    <button class="text-indigo-400 edit-user-btn" data-user-id="${user.id}" title="Kullan覺c覺y覺 D羹zenle">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                    </button>
                                    <button class="text-red-400 suspend-user-btn" data-user-id="${user.id}" title="Hesab覺 Ask覺ya Al/Aktifletir">
                                        <i data-lucide="lock" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            `;
                            userTableBody.appendChild(row);
                        });
                        userOffset += users.length;
                        loadMoreUsersButton.disabled = false;
                        lucide.createIcons();
                    }
                } catch (error) {
                    console.error("Kullan覺c覺lar y羹klenemedi:", error);
                    showNotification(`Kullan覺c覺lar y羹klenemedi: ${error.message}`, 'error');
                    userTableBody.innerHTML = `<tr class="border-b border-slate-800"><td class="p-3 text-red-400" colspan="5">Kullan覺c覺lar y羹klenemedi: ${error.message}</td></tr>`;
                    loadMoreUsersButton.disabled = true;
                }
            }

            loadMoreUsersButton.addEventListener('click', fetchUsers);

            async function fetchTaPredictions() {
                try {
                    const response = await fetch(`${TA_PREDICTIONS_API_URL}&page=${taPage}`, {
                        headers: { 'X-ADMIN-API-KEY': ADMIN_API_KEY }
                    });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(errorData.error || `HTTP Error: ${response.status}`);
                    }
                    const data = await response.json();

                    if (taPage === 1) taTableBody.innerHTML = '';
                    if (data.items && data.items.length) {
                        data.items.forEach(p => {
                            const row = document.createElement('tr');
                            row.className = 'border-b border-slate-800 hover:bg-slate-700';
                            row.innerHTML = `
                                <td class="p-3">${p.symbol}</td>
                                <td class="p-3">${p.target_price}</td>
                                <td class="p-3">${p.expected_gain_pct}</td>
                                <td class="p-3">${p.confidence_score}</td>
                                <td class="p-3">${new Date(p.created_at).toLocaleDateString('tr-TR')}</td>
                            `;
                            taTableBody.appendChild(row);
                        });
                        taPage += 1;
                        loadTaButton.disabled = data.items.length < data.per_page;
                        lucide.createIcons();
                    } else if (taPage === 1) {
                        taTableBody.innerHTML = '<tr class="border-b border-slate-800 hover:bg-slate-700"><td class="p-3" colspan="5">Tahmin bulunamad覺.</td></tr>';
                        loadTaButton.disabled = true;
                    } else {
                        loadTaButton.disabled = true;
                    }
                } catch (error) {
                    console.error('TA-Strategy tahminleri 癟ekilirken hata:', error);
                    taTableBody.innerHTML = `<tr class="border-b border-slate-800"><td class="p-3 text-red-400" colspan="5">Hata: ${error.message}</td></tr>`;
                    loadTaButton.disabled = true;
                }
            }

            loadTaButton.addEventListener('click', fetchTaPredictions);

            // Abonelik Kodu retme 襤levi
            generatePromoButton.addEventListener('click', async () => {
                const plan = promoPlanSelect.value;
                const duration = promoDurationInput.value;
                const uses = promoUsesInput.value;

                if (!plan || !duration || !uses) {
                    showNotification('L羹tfen t羹m promosyon kodu alanlar覺n覺 doldurun.', 'error');
                    return;
                }
                try {
                    const response = await fetch(PROMO_CODES_API_URL, {
                        method: 'POST',
                        headers: {
                            'X-ADMIN-API-KEY': ADMIN_API_KEY, // Bu, art覺k JWT ile deimeli
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ plan: plan, duration_days: parseInt(duration), max_uses: parseInt(uses) })
                    });
                    if (response.ok) {
                        const data = await response.json();
                        showNotification(`Kod baar覺yla 羹retildi: ${data.code} (Plan: ${data.plan}, S羹re: ${data.duration_days} g羹n, Kullan覺m: ${data.max_uses})`, 'success');
                        promoCodeMessage.textContent = `Kod baar覺yla 羹retildi: ${data.code} (Plan: ${data.plan}, S羹re: ${data.duration_days} g羹n, Kullan覺m: ${data.max_uses})`;
                        promoCodeMessage.classList.add('text-green-400', 'block');
                    } else {
                         const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                         showNotification(`Promosyon kodu 羹retilirken hata: ${errorData.error || response.statusText}`, 'error');
                         promoCodeMessage.textContent = `Hata: Promosyon kodu 羹retilemedi: ${errorData.error || response.statusText}`;
                         promoCodeMessage.classList.add('text-red-400', 'block');
                    }
                } catch (error) {
                    console.error('Promosyon kodu 羹retilirken a hatas覺:', error);
                    showNotification(`Promosyon kodu 羹retilirken bir a hatas覺 olutu.`, 'error');
                    promoCodeMessage.textContent = `Hata: A hatas覺 olutu.`;
                    promoCodeMessage.classList.add('text-red-400', 'block');
                }
            });


            // --- 襤癟erik Y繹netimi Alt B繹l羹m G繹r羹n羹rl羹羹 ---
            const manageCoinsBtn = document.getElementById('manage-coins-btn');
            const managePlansBtn = document.getElementById('manage-plans-btn');
            const manageBackgroundBtn = document.getElementById('manage-background-btn');
            const cryptoManagementArea = document.getElementById('crypto-management-area');
            const subscriptionPlanManagementArea = document.getElementById('subscription-plan-management-area');
            const backgroundManagementArea = document.getElementById('background-management-area');

            function hideAllContentManagementAreas() {
                cryptoManagementArea.classList.add('hidden');
                subscriptionPlanManagementArea.classList.add('hidden');
                backgroundManagementArea.classList.add('hidden');
            }

            manageCoinsBtn.addEventListener('click', () => {
                hideAllContentManagementAreas();
                cryptoManagementArea.classList.remove('hidden');
            });
            managePlansBtn.addEventListener('click', () => {
                hideAllContentManagementAreas();
                subscriptionPlanManagementArea.classList.remove('hidden');
                loadPlanSettings(); 
            });
            manageBackgroundBtn.addEventListener('click', () => {
                hideAllContentManagementAreas();
                backgroundManagementArea.classList.remove('hidden');
                loadBackgroundSetting(); 
            });

            // --- Kripto Y繹netimi ---
            const newCoinIdInput = document.getElementById('new-coin-id');
            const newCoinNameInput = document.getElementById('new-coin-name');
            const newCoinSymbolInput = document.getElementById('new-coin-symbol');
            const addNewCoinBtn = document.getElementById('add-new-coin-btn');
            const COINS_API_URL = `${BACKEND_BASE_URL}/api/admin/coins`;

            addNewCoinBtn.addEventListener('click', async () => {
                const coinId = newCoinIdInput.value;
                const coinName = newCoinNameInput.value;
                const coinSymbol = newCoinSymbolInput.value;

                if (!coinId || !coinName || !coinSymbol) {
                    showNotification('L羹tfen t羹m coin bilgilerini doldurun.', 'error');
                    return;
                }
                try {
                    const response = await fetch(COINS_API_URL, {
                        method: 'POST',
                        headers: {
                            'X-ADMIN-API-KEY': ADMIN_API_KEY, // Bu, art覺k JWT ile deimeli
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ id: coinId, name: coinName, symbol: coinSymbol })
                    });
                    if (response.ok) {
                        showNotification('Yeni coin baar覺yla eklendi: ' + coinName, 'success');
                        newCoinIdInput.value = '';
                        newCoinNameInput.value = '';
                        newCoinSymbolInput.value = '';
                    } else {
                         const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                         showNotification(`Coin eklenirken hata: ${errorData.error || response.statusText}`, 'error');
                    }
                } catch (error) {
                    console.error('Coin ekleme hatas覺:', error);
                    showNotification('Coin eklenirken bir a hatas覺 olutu.', 'error');
                }
            });

            // --- Abonelik Plan Y繹netimi ---
            const editPlanSelect = document.getElementById('edit-plan-select');
            const editPlanPriceInput = document.getElementById('edit-plan-price');
            const editPlanFeaturesTextarea = document.getElementById('edit-plan-features');
            const editPlanAnalyzeLimitInput = document.getElementById('edit-plan-analyze-limit');
            const editPlanLlmLimitInput = document.getElementById('edit-plan-llm-limit');
            const savePlanChangesBtn = document.getElementById('save-plan-changes-btn');
            const SUBSCRIPTION_PLANS_API_URL = `${BACKEND_BASE_URL}/api/admin/subscription_plans`;

            let currentPlanSettings = {}; // Backend'den 癟ekilen t羹m plan ayarlar覺n覺 tutar

            async function loadPlanSettings() {
                try {
                    const response = await fetch(SUBSCRIPTION_PLANS_API_URL, {
                        headers: { 'X-ADMIN-API-KEY': ADMIN_API_KEY } // Bu, art覺k JWT ile deimeli
                    });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(`HTTP Error: ${response.status} - ${errorData.error || response.statusText}`);
                    }
                    currentPlanSettings = await response.json(); // T羹m plan ayarlar覺n覺 kaydet
                    updatePlanEditForm(editPlanSelect.value); // Se癟ili plan覺 forma y羹kle
                } catch (error) {
                    console.error('Plan ayarlar覺 y羹klenirken hata:', error);
                    showNotification(`Plan ayarlar覺 y羹klenemedi: ${error.message}`, 'error');
                }
            }

            function updatePlanEditForm(selectedPlanId) {
                const planData = currentPlanSettings[selectedPlanId];
                if (planData) {
                    editPlanPriceInput.value = planData.price;
                    editPlanFeaturesTextarea.value = planData.features.join('\n');
                    editPlanAnalyzeLimitInput.value = planData.limits.analyze_calls_per_day;
                    editPlanLlmLimitInput.value = planData.limits.llm_queries_per_day;
                }
            }

            editPlanSelect.addEventListener('change', () => {
                updatePlanEditForm(editPlanSelect.value);
            });

            savePlanChangesBtn.addEventListener('click', async () => {
                const planId = editPlanSelect.value;
                const price = parseFloat(editPlanPriceInput.value);
                const features = editPlanFeaturesTextarea.value.split('\n').map(f => f.trim()).filter(f => f.length > 0);
                const analyzeLimit = parseInt(editPlanAnalyzeLimitInput.value);
                const llmLimit = parseInt(editPlanLlmLimitInput.value);

                if (isNaN(price) || isNaN(analyzeLimit) || isNaN(llmLimit)) {
                    showNotification('L羹tfen fiyat ve limit alanlar覺na ge癟erli say覺lar girin.', 'error');
                    return;
                }

                try {
                    const response = await fetch(SUBSCRIPTION_PLANS_API_URL, {
                        method: 'POST',
                        headers: {
                            'X-ADMIN-API-KEY': ADMIN_API_KEY, // Bu, art覺k JWT ile deimeli
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            plan_id: planId,
                            price: price,
                            features: features,
                            limits: {
                                analyze_calls_per_day: analyzeLimit,
                                llm_queries_per_day: llmLimit
                            }
                        })
                    });
                    if (response.ok) {
                        showNotification(`Plan ${planId.toUpperCase()} baar覺yla g羹ncellendi!`, 'success');
                        loadPlanSettings(); // Ayarlar覺 yeniden y羹kle
                    } else {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        showNotification(`Plan g羹ncellenirken hata: ${errorData.error || response.statusText}`, 'error');
                    }
                } catch (error) {
                    console.error('Plan kaydetme hatas覺:', error);
                    showNotification('Plan kaydedilirken bir a hatas覺 olutu.', 'error');
                }
            });

            // --- Web Sitesi Arka Plan Y繹netimi ---
            const backgroundUrlInput = document.getElementById('background-url-input');
            const updateBackgroundBtn = document.getElementById('update-background-btn');
            const currentBackgroundUrlSpan = document.getElementById('current-background-url');
            const WEBSITE_BACKGROUND_API_URL = `${BACKEND_BASE_URL}/api/admin/website_settings/background`;

            async function loadBackgroundSetting() {
                try {
                    const response = await fetch(WEBSITE_BACKGROUND_API_URL, {
                        headers: { 'X-ADMIN-API-KEY': ADMIN_API_KEY } // Bu, art覺k JWT ile deimeli
                    });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({error: 'Yan覺t JSON deil.'}));
                        throw new Error(`HTTP Error: ${response.status} - ${errorData.error || response.statusText}`);
                    }
                    const data = await response.json();
                    currentBackgroundUrlSpan.textContent = data.homepage_background_url;
                    backgroundUrlInput.value = data.homepage_background_url;
                    // Anasayfa arka plan覺n覺 da g羹ncelle
                    // Bu k覺s覺m production'da ana sayfa frontend'i taraf覺ndan y繹netilmelidir.
                    // document.body.style.backgroundImage = `url('${data.homepage_background_url}')`;
                } catch (error) {
                    console.error('Arka plan ayarlar覺 y羹klenirken hata:', error);
                    showNotification(`Arka plan ayarlar覺 y羹klenemedi: ${error.message}`, 'error');
                    currentBackgroundUrlSpan.textContent = 'Y羹klenemedi.';
                }
            });
        });
    </script>
</body>
</html>
